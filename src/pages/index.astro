---
import Footer from '@/components/Footer.astro';
import { Header } from '@/components/Header';
import { Banner } from '@/components/Banner';
import { SITE_DESCRIPTION, SITE_TITLE } from '@/consts';
import Card from '@/components/Card.astro';
import BaseLayout from '@/layouts/BaseLayout.astro';
import { ArrowRightIcon } from '@heroicons/react/24/solid';
import { categories, getCategoryPosts, getCategoryKeys } from '@/lib/categories';

const postSections = await Promise.all(
	getCategoryKeys()
		.filter((key) => key !== 'examples')
		.map(async (key) => ({
			title: `Recent ${categories[key].label}`,
			link: `/${key}`,
			posts: (await getCategoryPosts(key)).slice(0, 6),
		}))
);
---

<BaseLayout
		title={SITE_TITLE}
		description={SITE_DESCRIPTION}
		bodyClassName='bg-[linear-gradient(225deg,#deffbc70_30%,#ffdebf7d_70%)]'>
	<Header variant='animating' client:load />
	<Banner client:load />
	<main class="max-w-[90vw] mx-auto mb-[5vh]">
		<h2 class="font-rajdhani font-semibold text-3xl/normal md:text-4xl/normal lg:text-5xl/normal text-zinc-800 mt-[6vh] md:mt-[9vh] mb-[9vh] md:mb-[12vh]">
			Welcome, I'm Atharva ðŸ™‚ This is where I document what I'm learning while building real-world software.
		</h2>
		<section>
			{postSections.map(section =>
				section.posts.length > 0 ? (
					<div class="flex items-center justify-between font-rubik mb-6 not-first:mt-[6vh] not-first:md:mt-[9vh]">
						<h3 class="text-3xl">
							{section.title}
						</h3>
						<a class="inline-flex items-center text-orange-600 hover:underline" href={section.link}>
							View All
							<ArrowRightIcon className="w-4 h-4 ml-2" />
						</a>
					</div>
					<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 md:gap-10 list-none m-0 p-0">
						{section.posts.map((post) => (
							<Card id={post.id} post={post.data} link={section.link} />
						))}
					</div>
				) : null
			)}
		</section>
	</main>
	<Footer />
</BaseLayout>
